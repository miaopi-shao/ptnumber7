<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第七組專題</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

    <!-- 頁面頭部 -->
    <div class="header">
        <h1><strong><em>第七組專題</em></strong></h1>
    </div>

    <!-- 登入區域 -->
    <div class="login-box">
        <h3>帳號登錄</h3>
        <form id="loginForm">
            <input type="text" id="username" class="input-field" placeholder="帳號" required><br>
            <input type="password" id="password" class="input-field" placeholder="密碼" required><br>
            <button type="button" class="register-btn" id="showRegisterPopup">新帳戶註冊</button>
        </form>
    </div>

    <!-- 右側資訊區 -->
    <div class="info-section">
        <h3>專題成員：</h3>
        <ol>
            <li>   黃國豪</li>
            <li>   邵妙齊</li>
            <li>   JUR</li>
            <li>   RJ-捷</li>
            <li>   凱莉kelly</li>
        </ol>
        <h3>專題導師：</h3>
        <ul>
            <li>   簡志聰</li>
        </ul>
    </div>

    <!-- 註冊彈出視窗 -->
    <div id="registerPopup" class="register-popup">
        <span class="close-btn" id="closePopup">&times;</span>
        <h3>新帳戶註冊</h3>
        <form id="registerForm">
            <input type="text" id="newUsername" class="input-field" placeholder="帳號" required><br>
            <input type="text" id="newPhrase" class="input-field" placeholder="習慣用語" required><br>
            <label for="keepEveryN">選擇保留代碼間隔：</label>
            <input type="number" id="keepEveryN" class="input-field" value="1" min="1"><br>
            <button type="submit" class="register-btn">註冊</button>
        </form>
    </div>

    <!-- 底部 -->
    <div class="footer">
        <div class="members">
            <h3>專題結束，謝謝觀看</h3>
            <ul>
                <li>各位再見</li>
            
            </ul>
        </div>
    </div>

    <!-- 深藍色底部 -->
    <div class="dark-footer">
        <p>我是中間的內容呈現區域</p>
        <button id="startCrawler" class="register-btn" style="margin-bottom: 10px;">開始爬蟲</button>
        <!-- 顯示爬蟲結果的區塊 -->
        <div id="crawlerResult" style="background: #fff; color: #000; padding: 10px; margin-top: 10px; border-radius: 8px;"></div>
        <ul>
            <li>爬蟲用[ChromeDriver]下載區</li>
            <a href= https://googlechromelabs.github.io/chrome-for-testing/#stable target="_blank"> 請點擊前往</a>
            <li>注意!!!</li>
            <li>如果是舊版Google</li>
            <a href= https://developer.chrome.com/docs/chromedriver/downloads?hl=zh-tw target="_blank"> 請點擊這個去官網查詢</a>
            <a href= https://chromedriver.storage.googleapis.com/index.html target="_blank"> 並點擊這個去選擇版本號自行下載</a>
            <li>_______________功能分割__________________</li>
            <li> </li>
            <li>這是顏色的網址</li>
            <li><img src="{{ url_for('static', filename='images/90313.jpg') }}" alt="123"></li>
            <a href=https://www.bing.com/search?pglt=425&q=HTML+Color+Picker&cvid=10ca125bbb294230a174ecd81ebcd1b3&gs_lcrp=EgRlZGdlKgYIABBFGDkyBggAEEUYOTIGCAEQABhAMgYIAhAAGEAyBggDEAAYQDIGCAQQABhAMgYIBRAAGEAyBggGEAAYQDIGCAcQABhAMgYICBAAGEDSAQc2MzZqMGoxqAIIsAIB&FORM=ANNTA1&PC=ACTS target="_blank"> 顏色</a>
            <li>測試網址區域</li>
         
        </ul>
        <video width="240" height="120" controls>
            <source src="{{ url_for('static', filename='video/123.mp4') }}"   type="video/mp4">
            你的瀏覽器不支持播放此影片。
        </video>
    </div>

    <script>
        // 彈出註冊視窗
        document.getElementById('showRegisterPopup').addEventListener('click', function() {
            document.getElementById('registerPopup').style.display = 'block';
        });

        // 關閉註冊視窗
        document.getElementById('closePopup').addEventListener('click', function() {
            document.getElementById('registerPopup').style.display = 'none';
        });

        // 註冊提交表單
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('newUsername').value;
            const phrase = document.getElementById('newPhrase').value;
            const keepEveryN = document.getElementById('keepEveryN').value;

            fetch('/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username,
                    phrase,
                    keep_every_n: keepEveryN
                })
            })
            .then(response => response.json())
            .then(data => {
                alert(`註冊成功！帳號：${data.username}, 密碼：${data.encrypted_password}`);
                document.getElementById('registerPopup').style.display = 'none';
            })
            .catch(error => alert('註冊失敗，請稍後再試'));
        });
        
        // 新增：爬蟲功能按鈕事件
        document.getElementById('startCrawler').addEventListener('click', function() {
            // 顯示提示資訊
            document.getElementById('crawlerResult').innerHTML = '正在爬取中，請稍候...';
            
            // 使用 fetch 送出 GET 請求到 /scrape
            fetch('/scrape')
                .then(response => response.json())
                .then(data => {
                    if(data.error) {
                        document.getElementById('crawlerResult').innerHTML = `<span style="color:red;">錯誤：${data.error}</span>`;
                    } else {
                        document.getElementById('crawlerResult').innerHTML = data.scraped_data;
                    }
                })
                .catch(error => {
                    document.getElementById('crawlerResult').innerHTML = `<span style="color:red;">發生錯誤：${error}</span>`;
                });
        });
    </script>

</body>
</html>